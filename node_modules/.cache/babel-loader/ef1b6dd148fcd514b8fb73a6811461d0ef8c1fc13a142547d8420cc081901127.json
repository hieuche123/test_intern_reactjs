{"ast":null,"code":"/* global document */\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { useImperativeHandle, useEffect, useMemo, useRef, useContext, forwardRef, memo } from 'react';\nimport { applyReactStyle } from '../utils/apply-react-style';\nimport { MapContext } from './map';\nimport { arePointsEqual } from '../utils/deep-equal';\n/* eslint-disable complexity,max-statements */\nfunction Marker(props, ref) {\n  const {\n    map,\n    mapLib\n  } = useContext(MapContext);\n  const thisRef = useRef({\n    props\n  });\n  thisRef.current.props = props;\n  const marker = useMemo(() => {\n    let hasChildren = false;\n    React.Children.forEach(props.children, el => {\n      if (el) {\n        hasChildren = true;\n      }\n    });\n    const options = {\n      ...props,\n      element: hasChildren ? document.createElement('div') : null\n    };\n    const mk = new mapLib.Marker(options);\n    mk.setLngLat([props.longitude, props.latitude]);\n    mk.getElement().addEventListener('click', e => {\n      var _a, _b;\n      (_b = (_a = thisRef.current.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, {\n        type: 'click',\n        target: mk,\n        originalEvent: e\n      });\n    });\n    mk.on('dragstart', e => {\n      var _a, _b;\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('drag', e => {\n      var _a, _b;\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDrag) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('dragend', e => {\n      var _a, _b;\n      const evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    return mk;\n  }, []);\n  useEffect(() => {\n    marker.addTo(map.getMap());\n    return () => {\n      marker.remove();\n    };\n  }, []);\n  const {\n    longitude,\n    latitude,\n    offset,\n    style,\n    draggable = false,\n    popup = null,\n    rotation = 0,\n    rotationAlignment = 'auto',\n    pitchAlignment = 'auto'\n  } = props;\n  useEffect(() => {\n    applyReactStyle(marker.getElement(), style);\n  }, [style]);\n  useImperativeHandle(ref, () => marker, []);\n  if (marker.getLngLat().lng !== longitude || marker.getLngLat().lat !== latitude) {\n    marker.setLngLat([longitude, latitude]);\n  }\n  if (offset && !arePointsEqual(marker.getOffset(), offset)) {\n    marker.setOffset(offset);\n  }\n  if (marker.isDraggable() !== draggable) {\n    marker.setDraggable(draggable);\n  }\n  if (marker.getRotation() !== rotation) {\n    marker.setRotation(rotation);\n  }\n  if (marker.getRotationAlignment() !== rotationAlignment) {\n    marker.setRotationAlignment(rotationAlignment);\n  }\n  if (marker.getPitchAlignment() !== pitchAlignment) {\n    marker.setPitchAlignment(pitchAlignment);\n  }\n  if (marker.getPopup() !== popup) {\n    marker.setPopup(popup);\n  }\n  return createPortal(props.children, marker.getElement());\n}\nexport default memo(forwardRef(Marker));","map":{"version":3,"mappings":"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","names":["React","createPortal","useImperativeHandle","useEffect","useMemo","useRef","useContext","forwardRef","memo","applyReactStyle","MapContext","arePointsEqual","Marker","props","ref","map","mapLib","thisRef","current","marker","hasChildren","Children","forEach","children","el","options","element","document","createElement","mk","setLngLat","longitude","latitude","getElement","addEventListener","e","onClick","type","target","originalEvent","on","evt","lngLat","getLngLat","onDragStart","onDrag","onDragEnd","addTo","getMap","remove","offset","style","draggable","popup","rotation","rotationAlignment","pitchAlignment","lng","lat","getOffset","setOffset","isDraggable","setDraggable","getRotation","setRotation","getRotationAlignment","setRotationAlignment","getPitchAlignment","setPitchAlignment","getPopup","setPopup"],"sources":["E:\\LÃ m tiktok\\google-places-api-demo-type\\node_modules\\react-map-gl\\src\\components\\marker.ts"],"sourcesContent":["/* global document */\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\nimport {useImperativeHandle, useEffect, useMemo, useRef, useContext, forwardRef, memo} from 'react';\nimport {applyReactStyle} from '../utils/apply-react-style';\n\nimport type {MarkerEvent, MarkerDragEvent, PointLike, MarkerInstance} from '../types';\n\nimport {MapContext} from './map';\nimport {arePointsEqual} from '../utils/deep-equal';\n\nexport type MarkerProps<OptionsT, MarkerT extends MarkerInstance> = OptionsT & {\n  /** Longitude of the anchor location */\n  longitude: number;\n  /** Latitude of the anchor location */\n  latitude: number;\n\n  // These types will be further constraint by OptionsT\n  draggable?: boolean;\n  offset?: PointLike;\n  pitchAlignment?: string;\n  rotation?: number;\n  rotationAlignment?: string;\n  popup?: any;\n\n  /** CSS style override, applied to the control's container */\n  style?: React.CSSProperties;\n  onClick?: (e: MarkerEvent<MarkerT, MouseEvent>) => void;\n  onDragStart?: (e: MarkerDragEvent<MarkerT>) => void;\n  onDrag?: (e: MarkerDragEvent<MarkerT>) => void;\n  onDragEnd?: (e: MarkerDragEvent<MarkerT>) => void;\n  children?: React.ReactNode;\n};\n\n/* eslint-disable complexity,max-statements */\nfunction Marker<MarkerOptions, MarkerT extends MarkerInstance>(\n  props: MarkerProps<MarkerOptions, MarkerT>,\n  ref: React.Ref<MarkerT>\n) {\n  const {map, mapLib} = useContext(MapContext);\n  const thisRef = useRef({props});\n  thisRef.current.props = props;\n\n  const marker: MarkerT = useMemo(() => {\n    let hasChildren = false;\n    React.Children.forEach(props.children, el => {\n      if (el) {\n        hasChildren = true;\n      }\n    });\n    const options = {\n      ...props,\n      element: hasChildren ? document.createElement('div') : null\n    };\n\n    const mk = new mapLib.Marker(options) as MarkerT;\n    mk.setLngLat([props.longitude, props.latitude]);\n\n    mk.getElement().addEventListener('click', (e: MouseEvent) => {\n      thisRef.current.props.onClick?.({\n        type: 'click',\n        target: mk,\n        originalEvent: e\n      });\n    });\n\n    mk.on('dragstart', e => {\n      const evt = e as MarkerDragEvent<MarkerT>;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDragStart?.(evt);\n    });\n    mk.on('drag', e => {\n      const evt = e as MarkerDragEvent<MarkerT>;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDrag?.(evt);\n    });\n    mk.on('dragend', e => {\n      const evt = e as MarkerDragEvent<MarkerT>;\n      evt.lngLat = marker.getLngLat();\n      thisRef.current.props.onDragEnd?.(evt);\n    });\n\n    return mk;\n  }, []);\n\n  useEffect(() => {\n    marker.addTo(map.getMap());\n\n    return () => {\n      marker.remove();\n    };\n  }, []);\n\n  const {\n    longitude,\n    latitude,\n    offset,\n    style,\n    draggable = false,\n    popup = null,\n    rotation = 0,\n    rotationAlignment = 'auto',\n    pitchAlignment = 'auto'\n  } = props;\n\n  useEffect(() => {\n    applyReactStyle(marker.getElement(), style);\n  }, [style]);\n\n  useImperativeHandle(ref, () => marker, []);\n\n  if (marker.getLngLat().lng !== longitude || marker.getLngLat().lat !== latitude) {\n    marker.setLngLat([longitude, latitude]);\n  }\n  if (offset && !arePointsEqual(marker.getOffset(), offset)) {\n    marker.setOffset(offset);\n  }\n  if (marker.isDraggable() !== draggable) {\n    marker.setDraggable(draggable);\n  }\n  if (marker.getRotation() !== rotation) {\n    marker.setRotation(rotation);\n  }\n  if (marker.getRotationAlignment() !== rotationAlignment) {\n    marker.setRotationAlignment(rotationAlignment);\n  }\n  if (marker.getPitchAlignment() !== pitchAlignment) {\n    marker.setPitchAlignment(pitchAlignment);\n  }\n  if (marker.getPopup() !== popup) {\n    marker.setPopup(popup);\n  }\n\n  return createPortal(props.children, marker.getElement());\n}\n\nexport default memo(forwardRef(Marker));\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}